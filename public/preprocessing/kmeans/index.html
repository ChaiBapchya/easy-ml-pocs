<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta charset="utf-8">
  <title>Kmeans preprocessing</title>

  <meta name="generator" content="Hugo 0.64.0" />

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <!-- ** Plugins Needed for the Project ** -->
  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://master.d2ifucdfz09ieg.amplifyapp.com/plugins/bootstrap/bootstrap.min.css">

  <!-- themefy-icon -->
  <link rel="stylesheet" href="https://master.d2ifucdfz09ieg.amplifyapp.com/plugins/themify-icons/themify-icons.css">

  <!-- highlight -->
  <link rel="stylesheet" href="https://master.d2ifucdfz09ieg.amplifyapp.com/plugins/highlight/hybrid.css">

  <!--Favicon-->
  <link rel="icon" href="https://master.d2ifucdfz09ieg.amplifyapp.com/images/favicon.png" type="image/x-icon">

  <!-- fonts -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
  
  <style>
  :root{
    --primary-color:#02007e;
    --secondary-color:#f9f9f9;
    --text-color:#636363;
    --text-color-dark:#242738;
    --white-color:#ffffff;
    --font-family:Lato;
  }
  </style>

<!-- Main Stylesheet -->

<link rel="stylesheet" href="https://master.d2ifucdfz09ieg.amplifyapp.com/css/style.min.css" media="screen">

<!-- jquiry -->
<script src="https://master.d2ifucdfz09ieg.amplifyapp.com/plugins/jquery/jquery-1.12.4.js"></script>

<!-- jquary ui -->
<script src="https://master.d2ifucdfz09ieg.amplifyapp.com/plugins/jquery/jquery-ui.js"></script>

<!-- Bootstrap JS -->
<script src="https://master.d2ifucdfz09ieg.amplifyapp.com/plugins/bootstrap/bootstrap.min.js"></script>

<!-- match-height JS -->
<script src="https://master.d2ifucdfz09ieg.amplifyapp.com/plugins/match-height/jquery.matchHeight-min.js"></script>

<!-- highlight -->
<script src="https://master.d2ifucdfz09ieg.amplifyapp.com/plugins/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

</head>
<body>
  
  <!-- navigation -->
  <header class="shadow-bottom sticky-top bg-white">
    <div class="container">
      <nav class="navbar navbar-expand-md navbar-light">
  <a class="navbar-brand" href="/">
    
    
    
    Easy ML PoCs
    
  </a>
  <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation"
    aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse text-center" id="navigation">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item">
        <a class="nav-link text-dark" href="/">Home</a>
      </li>
      
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle text-dark" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
          aria-expanded="false">
          code
        </a>
        <div class="dropdown-menu">
          
          <a class="dropdown-item" href="/preprocessing">Preprocessing</a>
          
          <a class="dropdown-item" href="/training">Training</a>
          
          <a class="dropdown-item" href="/inference">Inference</a>
          
        </div>
      </li>
      
      
      
      <li class="nav-item">
        <a class="nav-link text-dark" href="/usecases">Use cases</a>
      </li>
      
      
      
      <li class="nav-item">
        <a class="nav-link text-dark" href="/contact">contact</a>
      </li>
      
      
      
      <li class="nav-item">
        <a class="nav-link text-dark" href="/faq">Faq</a>
      </li>
      
      
    </ul>
    
  </div>
</nav>
    </div>
  </header>
  <!-- /navigation -->
  
  <div id="content">

<!-- details page -->
<section class="single section bg-gray pb-0">
  <div class="container">
    <div class="row">
      <div class="col-lg-3">
        <div class="mb-5 bg-white p-4 sticky-top top-100">
          <ul class="list-styled">
            
            <a class="d-block h4 back-btn" href="/"></a>
            
            




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/usecases/" title="Use cases" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/usecases/">
    Use cases
  </a>
  
  
  <ul>
    
    
    
    
    

    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/usecases/pneumonia/" title="Pneumonia detection from Chest X-ray images" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/usecases/pneumonia/">
    Pneumonia detection from Chest X-ray images
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/usecases/rossman/" title="Rossman store sales forecast" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/usecases/rossman/">
    Rossman store sales forecast
  </a>
  
  


    
    
  </ul>
</li>



            
            




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/" title="1. Preprocessing" class="sidelist
  parent
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/">
    1. Preprocessing
  </a>
  
  
  <ul>
    
    
    
    
    

    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/kmeans/" title="Kmeans preprocessing" class="sidelist
  parent
  active
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/kmeans/">
    Kmeans preprocessing
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/automl/" title="Autopilot preprocessing" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/automl/">
    Autopilot preprocessing
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/deepar/" title="DeepAR preprocessing" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/deepar/">
    DeepAR preprocessing
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/personalize/" title="Personalize preprocessing" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/personalize/">
    Personalize preprocessing
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/selecting/" title="Select, drop or extract Columns" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/selecting/">
    Select, drop or extract Columns
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/splittesttrain/" title="Split dataset to Train and Test" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/splittesttrain/">
    Split dataset to Train and Test
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/uploadtos3/" title="Upload to s3" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/uploadtos3/">
    Upload to s3
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/forecast/" title="Forecast preprocessing" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/forecast/">
    Forecast preprocessing
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/rekogscenes/" title="Rekognition Classification preprocessing" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/rekogscenes/">
    Rekognition Classification preprocessing
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/xgboost/" title="Xgboost preprocessing" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/xgboost/">
    Xgboost preprocessing
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/blazingtext/" title="Blazingtext preprocessing" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/blazingtext/">
    Blazingtext preprocessing
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/comprehend/" title="Comprehend preprocessing" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/comprehend/">
    Comprehend preprocessing
  </a>
  
  


    
    
  </ul>
</li>



            
            




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/training/" title="2. Training" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/training/">
    2. Training
  </a>
  
  
  <ul>
    
    
    
    
    

    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/training/forecast/" title="Forecast training" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/training/forecast/">
    Forecast training
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/training/personalize/" title="Personalize training" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/training/personalize/">
    Personalize training
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/training/blazingtext/" title="BlazingText training" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/training/blazingtext/">
    BlazingText training
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/training/deepar/" title="DeepAR training" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/training/deepar/">
    DeepAR training
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/training/kmeans/" title="Kmeans training" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/training/kmeans/">
    Kmeans training
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/training/comprehend/" title="Comprehend training" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/training/comprehend/">
    Comprehend training
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/training/automl/" title="Autopilot Training" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/training/automl/">
    Autopilot Training
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/training/rekogscenes/" title="Rekognition Classification training" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/training/rekogscenes/">
    Rekognition Classification training
  </a>
  
  


    
    
  </ul>
</li>



            
            




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/inference/" title="3. Inference" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/inference/">
    3. Inference
  </a>
  
  
  <ul>
    
    
    
    
    

    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/inference/personalize/" title="Personalize inference" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/inference/personalize/">
    Personalize inference
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/inference/blazingtext/" title="BlazingText Inference" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/inference/blazingtext/">
    BlazingText Inference
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/inference/deepar/" title="DeepAR Inference" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/inference/deepar/">
    DeepAR Inference
  </a>
  
  


    
    
    
    




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/inference/rekogscenes/" title="Rekognition Classification inference" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/inference/rekogscenes/">
    Rekognition Classification inference
  </a>
  
  


    
    
  </ul>
</li>



            
            




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/faq/" title="Frequently Asked Questions" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/faq/">
    Frequently Asked Questions
  </a>
  
  


            
            




<li data-nav-id="https://master.d2ifucdfz09ieg.amplifyapp.com/contact/" title="Got Any Questions" class="sidelist
  
  
  ">
  <a href="https://master.d2ifucdfz09ieg.amplifyapp.com/contact/">
    Got Any Questions
  </a>
  
  


            
          </ul>
        </div>
      </div>
      <div class="col-lg-9">
        <div class="p-5 bg-white">
          <h2 class="mb-5">Kmeans preprocessing</h2>
          
          <div class="content"><p>Per the <a href="https://docs.aws.amazon.com/sagemaker/latest/dg/k-means.html#km-inputoutput">documentation</a>, &ldquo;For training, the k-means algorithm expects data to be provided in the train channel (recommended S3DataDistributionType=ShardedByS3Key), with an optional test channel (recommended S3DataDistributionType=FullyReplicated) to score the data on. Both recordIO-wrapped-protobuf and CSV formats are supported for training. You can use either File mode or Pipe mode to train models on data that is formatted as recordIO-wrapped-protobuf or as CSV.&rdquo;</p>
<p>Using the python SDK for Sagemaker, there is a far simpler way to use KMeans (yes, even simpler than a CSV)</p>
<p>Assume you start with a CSV that looks like the following (this is sample data from s3://aws-ml-blog-sagemaker-census-segmentation)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">CensusId	State	County	TotalPop	Men		Women	Hispanic	White	Black	Native ...
0	1001	Alabama	Autauga	55221		26745	28476	2.6			75.8	18.5	0.4	...
1	1003	Alabama	Baldwin	195121		95314	99807	4.5			83.1	9.5		0.6	...
2	1005	Alabama	Barbour	26932		14497	12435	4.6			46.2	46.7	0.2 ...	
3	1007	Alabama	Bibb	22604		12073	10531	2.2			74.5	21.4	0.4	...
4	1009	Alabama	Blount	57710		28512	29198	8.6			87.9	1.5		0.3	...
</code></pre></div><p>Read the CSV file</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">data.csv</span><span style="color:#e6db74">&#39;</span>, header<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, delimiter<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">,</span><span style="color:#e6db74">&#34;</span>, low_memory<span style="color:#f92672">=</span>False)
</code></pre></div><p>Drop any column that has items that are NaN (Not a Number)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data<span style="color:#f92672">.</span>dropna(inplace<span style="color:#f92672">=</span>True)
</code></pre></div><p>Consider doing one-hot-encoding or any other data preprocessing, but use this as  template for the minimal data preprocessing that you will need to do. (Optional) For example, you can use SKlearn to do some standard preprocessing like scaling:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> MinMaxScaler
scaler<span style="color:#f92672">=</span>MinMaxScaler()
data_scaled<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(scaler<span style="color:#f92672">.</span>fit_transform(data))
data_scaled<span style="color:#f92672">.</span>columns<span style="color:#f92672">=</span>data<span style="color:#f92672">.</span>columns
data_scaled<span style="color:#f92672">.</span>index<span style="color:#f92672">=</span>data<span style="color:#f92672">.</span>index
</code></pre></div><p>Make sure your numerical values in the dataframe are Float values:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">train_data <span style="color:#f92672">=</span> data_scaled<span style="color:#f92672">.</span>values<span style="color:#f92672">.</span>astype(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">float32</span><span style="color:#e6db74">&#39;</span>)
</code></pre></div><p><strong>Note</strong> - Consider using the dataframe as is, since the next <a href="../../training/kmeans">training</a> step will become easier. If you really need to convert to CSV, do:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">train_data<span style="color:#f92672">.</span>to_csv(index<span style="color:#f92672">=</span>False)
</code></pre></div><h3 id="optional">Optional</h3>
<p>It is possible that you have a large number of columns in your training dataset; it is common practice to then use Principle Component Analysis to reduce the number of columns while retaining most of the information. We can use the Sagemaker built in PCA algorithm to achieve this.</p>
<p>Using the train_data dataframe, you can do:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sagemaker <span style="color:#f92672">import</span> PCA
<span style="color:#f92672">from</span> sagemaker <span style="color:#f92672">import</span> get_execution_role
role <span style="color:#f92672">=</span> get_execution_role()
num_components<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>

pca_SM <span style="color:#f92672">=</span> PCA(role<span style="color:#f92672">=</span>role,
             train_instance_count<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,
             train_instance_type<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ml.c4.xlarge</span><span style="color:#e6db74">&#39;</span>,
             output_path<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">s3://</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span> bucket <span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">/counties/</span><span style="color:#e6db74">&#39;</span>,
             num_components<span style="color:#f92672">=</span>num_components)
</code></pre></div><p>&hellip; and then train a PCA model:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">train_data <span style="color:#f92672">=</span> train_data<span style="color:#f92672">.</span>values<span style="color:#f92672">.</span>astype(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">float32</span><span style="color:#e6db74">&#39;</span>)
pca_SM<span style="color:#f92672">.</span>fit(pca_SM<span style="color:#f92672">.</span>record_set(train_data))
</code></pre></div><p>This reduces the number of columns you have in your original dataset to <code>num_components=20</code></p>
<p>Once you are done training, store the new &ldquo;components&rdquo; in a new dataset, which will be your training dataset for Kmeans.</p>
<p>To do this, first deploy your model to Sagemaker, and then do a prediction:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pca_predictor <span style="color:#f92672">=</span> pca_SM<span style="color:#f92672">.</span>deploy(initial_instance_count<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, instance_type<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ml.t2.medium</span><span style="color:#e6db74">&#39;</span>)
result <span style="color:#f92672">=</span> pca_predictor<span style="color:#f92672">.</span>predict(train_data)
</code></pre></div><p>Then recover your train dataset to be used with kmeans</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data_transformed<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame()
last_n <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>

<span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> result:
    b<span style="color:#f92672">=</span>a<span style="color:#f92672">.</span>label[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">projection</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>float32_tensor<span style="color:#f92672">.</span>values
    data_transformed<span style="color:#f92672">=</span>data_transformed<span style="color:#f92672">.</span>append([list(b)])
data_transformed<span style="color:#f92672">.</span>index<span style="color:#f92672">=</span>data_scaled<span style="color:#f92672">.</span>index <span style="color:#75715e">#Note that this uses indexes from a dataframe we used in previous steps</span>
data_transformed<span style="color:#f92672">=</span>data_transformed<span style="color:#f92672">.</span>iloc[:,<span style="color:#f92672">-</span>last_n:]
data_transformed<span style="color:#f92672">.</span>columns<span style="color:#f92672">=</span>PCA_list
</code></pre></div><p>The variable <code>last_n</code> controls the number of columns you want to use (here, we are using the last 5 columns of data). You can also use all columns of <code>data_transformed</code> as it is already a dataset with only 20 columns, whereas your original dataset for Kmeans may have been 100&rsquo;s or 1000&rsquo;s of columns.</p>
</div>
          
          <p class="post-meta border-bottom pb-3 mb-0 mt-3">Updated on 02 Mar 2020</p>
          <nav class="pagination mt-3">
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            

            
            <a class="nav nav-prev" href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/"><i class="ti-arrow-left mr-2"></i> <span class="d-none d-md-block">1. Preprocessing</span></a>
            
            
            <a class="nav nav-next" href="https://master.d2ifucdfz09ieg.amplifyapp.com/preprocessing/automl/"> <span class="d-none d-md-block">Autopilot preprocessing</span><i class="ti-arrow-right ml-2"></i></a>
            
          </nav>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- /details page -->






  </div><!-- footer -->
<footer class="section bg-gray pb-0">
  <div class="container">
    <div class="row">
      <div class="col-md-8 text-md-left text-center">
       <p>Documents are copyright © AWS 2020.</p>
      </div>
      <div class="col-md-4 text-md-right text-center">
        <ul class="list-inline mb-3">
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="#"><i class="ti-facebook"></i></a></li>
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="#"><i class="ti-twitter-alt"></i></a></li>
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="#"><i class="ti-vimeo-alt"></i></a></li>
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="#"><i class="ti-linkedin"></i></a></li>
          
        </ul>
      </div>
    </div>
  </div>
</footer>
<!-- /footer -->

<!-- Main Script -->

<script src="https://master.d2ifucdfz09ieg.amplifyapp.com/js/script.min.js"></script></body>

</html>